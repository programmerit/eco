<?xml version="1.0"?>

<f:view xmlns="http://www.w3.org/1999/xhtml"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:ui="http://java.sun.com/jsf/facelets">
	<h:head />
	<h:body>
		<h:form id="vacancySearchForm">

			<h:link value="Show/Hide filter" styleClass="label"
				onclick="toggle('#{requestScope.filterGrid.clientId}'); return false;"
				onmouseover="toggle('#{requestScope.filterGrid.clientId}'); return false;" />

			<p:panelGrid columns="4" layout="grid"
				style="margin-bottom: 7px!important;">
				<h:panelGroup>
					<p:inputText id="filter_vGlobalString"
						value="#{vacancyFilterBean.global}" placeholder="Everything">
						<p:ajax event="keyup" delay="1000"
							oncomplete="PF('wVacancies').filter();" />
					</p:inputText>
					<p:tooltip for="filter_vGlobalString" value="Filter Everything"
						showEffect="clip" hideEffect="explode" />

				</h:panelGroup>

				<h:panelGroup>
					<p:inputText id="filter_vName" value="#{vacancyFilterBean.name}"
						placeholder="Name">
						<p:ajax event="keyup" delay="1000"
							oncomplete="PF('wVacancies').filter();" />
					</p:inputText>
					<p:tooltip for="filter_vName" value="Filter [Vacancy's Name]"
						showEffect="clip" hideEffect="explode" />

				</h:panelGroup>

				<h:panelGroup>
					<p:inputText id="filter_vTitles"
						value="#{vacancyFilterBean.titles}" placeholder="Titles">
						<p:ajax event="keyup" delay="1000"
							oncomplete="PF('wVacancies').filter();" />
					</p:inputText>
					<p:tooltip for="filter_vTitles" value="Filter [Titles]"
						showEffect="clip" hideEffect="explode" />
				</h:panelGroup>

				<h:panelGroup>
					<p:spinner id="filter_vNumberOfPositionFrom"
						value="#{vacancyFilterBean.numberOfPositionFrom}">
						<p:ajax process="@this" oncomplete="PF('wVacancies').filter();" />
					</p:spinner>
					<p:tooltip for="filter_vNumberOfPositionFrom"
						value="Filter [Number of Position] From" showEffect="clip"
						hideEffect="explode" />
					<br />

					<p:spinner id="filter_vNumberOfPositionTo" min="-1"
						value="#{vacancyFilterBean.numberOfPositionTo}">
						<p:ajax process="@this" oncomplete="PF('wVacancies').filter();" />
					</p:spinner>
					<p:tooltip for="filter_vNumberOfPositionTo" min="-1"
						value="Filter [Number of Position] To" showEffect="clip"
						hideEffect="explode" />
				</h:panelGroup>
			</p:panelGrid>
		</h:form>

		<h:form id="vacancyMainForm">

			<p:remoteCommand name="refreshVacancyTable"
				update=":vacancyMainForm:vacancies" />

			<p:dataTable id="vacancies" var="vacancy" widgetVar="wVacancies"
				reflow="true" value="#{vacancyBean.lazyDataModel}"
				paginatorAlwaysVisible="false" paginator="true" rows="25"
				paginatorPosition="bottom"
				paginatorTemplate="{FirstPageLink} {PreviousPageLink} {CurrentPageReport} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
				rowsPerPageTemplate="10, 25, 50" lazy="true" selectionMode="single"
				selection="#{vacancyBean.selectedItem}" rowKey="#{vacancy.id}"
				emptyMessage="No vacancies found">
				<p:ajax event="rowDblselect"
					listener="#{vacancyBean.onRowDblSelect}"
					update=":VacancyPanelGroup" />

				<p:column headerText="ID">
					<h:outputText value="#{vacancy.id}" />
				</p:column>

				<p:column headerText="Titles" sortBy="#{vacancyFilterBean.titles}">
					<h:outputText value="#{vacancy.titles}" />
				</p:column>

				<p:column headerText="Number of position"
					sortBy="#{vacancyFilterBean.numberOfPosition}">
					<h:outputText value="#{vacancy.numberOfPosition}" />
				</p:column>

				<p:column headerText="">
					<p:commandLink value="Apply Now" />
				</p:column>


			</p:dataTable>
		</h:form>

	</h:body>
	<script type="text/javascript">
		function toggle(id) {
			var element = document.getElementById(id);
			if (element.style.display == 'block') {
				element.style.display = 'none';
			} else {
				element.style.display = 'block'
			}
		}
	</script>
</f:view>