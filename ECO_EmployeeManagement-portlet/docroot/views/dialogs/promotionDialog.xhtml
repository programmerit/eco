<?xml version="1.0"?>

<f:view xmlns="http://www.w3.org/1999/xhtml"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	xmlns:pe="http://primefaces.org/ui/extensions"
	xmlns:eco="http://java.sun.com/jsf/composite/eco_composite">
	<h:head />

	<h:body>
		<h:form id="promotionForm">
			<p:dialog widgetVar="wPromotionDialog" header="Promotion Form"
				modal="true">
				<p:outputPanel id="promotionOutputPanel" autoUpdate="true">
					<p:panelGrid columns="2">
						<h:outputText value="Fullname" />
						<h:outputText id="pFullName"
							value="#{promotionBean.employeeIndexedItem.fullName}" />

						<h:outputText value="Current Titles" />
						<h:outputText id="pTitles" value="#{promotionBean.oldTitles.name}" />

						<h:outputText value="Promoted Titles" />
						<h:panelGrid columns="2">

							<h:outputText value="Devision" />
							<p:selectOneMenu id="devisionSelect"
								value="#{promotionBean.devision}" converter="devisionConverter"
								effect="fade" filter="true" filterMatchMode="contains" var="d">
								<p:ajax
									update="departmentSelect unitSelect unitGroupSelect titlesSelect"
									listener="#{promotionBean.onDevisionChanged}" />

								<f:selectItem itemLabel="Devision" itemValue="" />
								<f:selectItems value="#{promotionBean.devisions}" var="d"
									itemLabel="#{d.name}" itemValue="#{d}" />
								<p:column>
					                #{d.name}
					            </p:column>
							</p:selectOneMenu>

							<h:outputText value="Department" />
							<p:selectOneMenu id="departmentSelect"
								value="#{promotionBean.department}"
								converter="departmentConverter" effect="fade" filter="true"
								filterMatchMode="contains" var="d">
								<p:ajax update="unitSelect unitGroupSelect titlesSelect"
									listener="#{promotionBean.onDepartmentChanged}" />

								<f:selectItem itemLabel="Department" itemValue="" />
								<f:selectItems value="#{promotionBean.departments}" var="d"
									itemLabel="#{d.name}" itemValue="#{d}" />
								<p:column>
					                #{d.name}
					            </p:column>
							</p:selectOneMenu>

							<h:outputText value="Unit" />
							<p:selectOneMenu id="unitSelect" value="#{promotionBean.unit}"
								converter="unitConverter" effect="fade" filter="true"
								filterMatchMode="contains" var="u">
								<p:ajax update="unitGroupSelect titlesSelect"
									listener="#{promotionBean.onUnitChanged}" />

								<f:selectItem itemLabel="Unit" itemValue="" />
								<f:selectItems value="#{promotionBean.units}" var="u"
									itemLabel="#{u.name}" itemValue="#{u}" />
								<p:column>
					                #{u.name}
					            </p:column>
							</p:selectOneMenu>

							<h:outputText value="Group" />
							<p:selectOneMenu id="unitGroupSelect"
								value="#{promotionBean.unitGroup}"
								converter="unitGroupConverter" effect="fade" filter="true"
								filterMatchMode="contains" var="g">
								<p:ajax update="titlesSelect"
									listener="#{promotionBean.onUnitGroupChanged}" />

								<f:selectItem itemLabel="Group" itemValue="" />
								<f:selectItems value="#{promotionBean.unitGroups}" var="g"
									itemLabel="#{g.name}" itemValue="#{g}" />
								<p:column>
					                #{g.name}
					            </p:column>
							</p:selectOneMenu>

							<h:outputText value="Titles" />
							<p:selectOneMenu id="titlesSelect"
								value="#{promotionBean.titles}" converter="titlesConverter"
								effect="fade" filter="true" filterMatchMode="contains" var="t"
								required="true" validatorMessage="[Titles] is required">

								<f:selectItem itemLabel="Titles" itemValue="" />
								<f:selectItems value="#{promotionBean.titlesList}" var="t"
									itemLabel="#{t.name}" itemValue="#{t}" />
								<p:column>
					                #{t.name}
					            </p:column>
							</p:selectOneMenu>
						</h:panelGrid>

						<h:outputText value="Promoted Date" />
						<p:calendar pattern="dd/MM/yyyy"
							value="#{promotionBean.promotedHistory.promotedDate}"
							required="true" />

						<h:outputText value="Comments" />
						<p:inputTextarea value="#{promotionBean.promotedHistory.comment}"
							placeholder="Input Comments Here" />

					</p:panelGrid>
				</p:outputPanel>
				<p:commandButton value="Promote!" styleClass="RedButton"
					actionListener="#{promotionBean.onSave}" update=":growl"
					oncomplete="refreshEmployees(); PF('wPromotionDialog').hide()" />
				<p:commandButton value="Cancel"
					actionListener="#{promotionBean.onCancelEdit}"
					onclick="PF('wPromotionDialog').hide()">
					<p:resetInput target="promotionForm" />
				</p:commandButton>
			</p:dialog>
		</h:form>
	</h:body>
</f:view>