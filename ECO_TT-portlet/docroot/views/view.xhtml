<?xml version="1.0"?>

<f:view xmlns="http://www.w3.org/1999/xhtml"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	xmlns:pe="http://primefaces.org/ui/extensions">
	<h:head />
	<h:body>

		<h:link outcome="importExport" value="Import/Export " /> | 
		<h:link outcome="timetracking" value="Detail TimeTracking " />
		<p:ajaxStatus onstart="PF('statusDialog').show()"
			onsuccess="PF('statusDialog').hide()" />

		<p:dialog widgetVar="statusDialog" modal="false" draggable="false"
			closable="false" resizable="false" showHeader="false"
			styleClass="eco-ajax-loading">
			<p:graphicImage name="/images/ajax-loader1.gif" />
		</p:dialog>

		<h:form id="searchForm">
			<h:outputText value="Filter:" styleClass="label" />
			<p:panelGrid columns="5" layout="grid" styleClass="filter-grid"
				style="margin-bottom: 7px!important; color: black!important;">
				<h:panelGroup>
					<p:inputText id="filter_globalString"
						value="#{timeTrackingFilterBean.globalString}"
						placeholder="Everything" style="width: 150px;">
						<p:ajax event="keyup" oncomplete="PF('wReportTable').filter();;" />
					</p:inputText>
					<p:tooltip for="filter_globalString" value="Filter Everything"
						showEffect="clip" hideEffect="explode" />
					<br />

					<p:inputText id="filter_fullName"
						value="#{timeTrackingFilterBean.fullName}" placeholder="FullName"
						style="width: 150px;">
						<p:ajax event="keyup" oncomplete="PF('wReportTable').filter();;" />
					</p:inputText>
					<p:tooltip for="filter_fullName" value="Filter [Fullname]"
						showEffect="clip" hideEffect="explode" />
				</h:panelGroup>

				<h:panelGroup>
					<p:inputText id="filter_empCode"
						value="#{timeTrackingFilterBean.employeeCode}"
						placeholder="Employee Code" style="width: 150px">
						<p:ajax event="keyup" oncomplete="PF('wReportTable').filter();;" />
					</p:inputText>
					<p:tooltip for="filter_empCode" value="Filter [Employee Code]"
						showEffect="clip" hideEffect="explode" />
				</h:panelGroup>

				<h:panelGroup>
					<p:selectOneMenu id="devisionSelect"
						value="#{timeTrackingFilterBean.devision}"
						converter="devisionConverter" effect="fade" filter="true"
						filterMatchMode="contains" var="d">
						<p:ajax listener="#{timeTrackingFilterBean.onDevisionChanged}"
							update="departmentSelect unitSelect"
							oncomplete="PF('wReportTable').filter();;" />

						<f:selectItem itemLabel="ALL DEVISION" itemValue="" />
						<f:selectItems value="#{timeTrackingFilterBean.devisions}" var="d"
							itemLabel="#{d.name}" itemValue="#{d}" />
						<p:column>
					                #{d.name}
					            </p:column>
					</p:selectOneMenu>
					<p:tooltip for="devisionSelect" value="Filter [Devision]"
						showEffect="clip" hideEffect="explode" />
					<br />

					<p:selectOneMenu id="departmentSelect"
						value="#{timeTrackingFilterBean.department}"
						converter="departmentConverter" effect="fade" filter="true"
						filterMatchMode="contains" var="d">
						<p:ajax listener="#{timeTrackingFilterBean.onDepartmentChanged}"
							update="unitSelect unitGroupSelect titlesSelect"
							oncomplete="PF('wReportTable').filter();;" />

						<f:selectItem itemLabel="ALL DEPARTMENT" itemValue="" />
						<f:selectItems value="#{timeTrackingFilterBean.departments}"
							var="d" itemLabel="#{d.name}" itemValue="#{d}" />
						<p:column>
					                #{d.name}
					            </p:column>
					</p:selectOneMenu>
					<p:tooltip for="departmentSelect" value="Filter [Department]"
						showEffect="clip" hideEffect="explode" />
				</h:panelGroup>

				<h:panelGroup>
					<h:panelGrid columns="2" border="0">
						<p:selectOneMenu id="unitSelect"
							value="#{timeTrackingFilterBean.unit}" converter="unitConverter"
							effect="fade" filter="true" filterMatchMode="contains" var="u">
							<p:ajax listener="#{timeTrackingFilterBean.onUnitChanged}"
								update="unitGroupSelect titlesSelect"
								oncomplete="PF('wReportTable').filter();;" />

							<f:selectItem itemLabel="ALL UNIT" itemValue="" />
							<f:selectItems value="#{timeTrackingFilterBean.units}" var="u"
								itemLabel="#{u.name}" itemValue="#{u}" />
							<p:column>
					                #{u.unitId} - #{u.name}
					            </p:column>
						</p:selectOneMenu>
						<p:tooltip for="unitSelect" value="Filter [Unit]"
							showEffect="clip" hideEffect="explode" />

						<p:selectOneMenu id="unitGroupSelect"
							value="#{timeTrackingFilterBean.unitGroup}"
							converter="unitGroupConverter" effect="fade" filter="true"
							filterMatchMode="contains" var="d">
							<p:ajax listener="#{timeTrackingFilterBean.onUnitGroupChanged}"
								update="titlesSelect" oncomplete="PF('wReportTable').filter();;" />

							<f:selectItem itemLabel="ALL GROUP" itemValue="" />
							<f:selectItems value="#{timeTrackingFilterBean.unitGroups}"
								var="g" itemLabel="#{g.name}" itemValue="#{g}" />

							<p:column>
					                #{g.name}
					            </p:column>
						</p:selectOneMenu>
						<p:tooltip for="unitGroupSelect" value="Filter [UnitGroup]"
							showEffect="clip" hideEffect="explode" />


						<p:selectOneMenu id="titlesSelect"
							value="#{timeTrackingFilterBean.titles}"
							converter="titlesConverter" effect="fade" filter="true"
							filterMatchMode="contains" var="t">
							<p:ajax oncomplete="PF('wReportTable').filter();;" />

							<f:selectItem itemLabel="ALL TITLES" itemValue="" />
							<f:selectItems value="#{timeTrackingFilterBean.titlesList}"
								var="t" itemLabel="#{t.name}" itemValue="#{t}" />

							<p:column>
					                #{t.name}
					            </p:column>
						</p:selectOneMenu>
						<p:tooltip for="titlesSelect" value="Filter [Titles]"
							showEffect="clip" hideEffect="explode" />
					</h:panelGrid>
				</h:panelGroup>

				<h:panelGroup>
					<p:selectOneMenu id="monthSelect"
						value="#{timeTrackingFilterBean.month}" var="m">
						<p:ajax oncomplete="PF('wReportTable')" />
						<f:selectItems value="#{timeTrackingFilterBean.months}" var="m"
							itemLabel="#{timeTrackingFilterBean.getMonthName(m)}"
							itemValue="#{m}" />
						<p:ajax update=":reportForm:reports" />
						<p:column>#{timeTrackingFilterBean.getMonthName(m)}</p:column>
					</p:selectOneMenu>
					<br />
					<p:selectOneMenu id="valueFilterSelect"
						value="#{timeTrackingFilterBean.valueFilter}" var="v">
						<p:ajax oncomplete="PF('wReportTable')" />
						<f:selectItems value="#{timeTrackingFilterBean.valuesFilter}"
							var="v" itemLabel="#{v}" itemValue="#{v}" />
						<p:ajax update=":reportForm:reports" />
						<p:column>#{v}</p:column>
					</p:selectOneMenu>
				</h:panelGroup>
			</p:panelGrid>
		</h:form>
		<h:form id="reportForm">
			<p:dataTable id="reports" widgetVar="wReportTable" var="t"
				lazy="true" value="#{timeTrackingReportBean.lazyDataModel}"
				paginatorAlwaysVisible="true" paginator="true" rows="10"
				paginatorPosition="bottom"
				paginatorTemplate="{FirstPageLink} {PreviousPageLink} {CurrentPageReport} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
				rowsPerPageTemplate="10,25,50" scrollable="true"
				selection="#{timeTrackingReportBean.selectedEmpTimeTrackingIndexedItem}"
				selectionMode="single" style="margin-top:40px">


				<p:columnGroup type="header">
					<p:row>
						<p:column rowspan="3" headerText="Emp Code" width="50" />
						<p:column rowspan="3" headerText="Name" width="100" />
						<p:column rowspan="3" headerText="Values" width="80" />
						<p:column colspan="#{timeTrackingReportBean.getDatesSize(7)}"
							headerText="TIME TRACKING RECORDS 2015" width="2000" />
						<p:column rowspan="3" headerText="Grand Total" width="80"
							style="font-size: 15px; font-weight: bold;" />
					</p:row>
					<p:row>
						<ui:repeat
							value="#{timeTrackingReportBean.shortDatesOfMonthStrings}"
							var="d">
							<p:column headerText="#{d}" width="80" />
						</ui:repeat>
					</p:row>
					<p:row>
						<ui:repeat value="#{timeTrackingReportBean.daysOfMonthStrings}"
							var="d">
							<p:column headerText="#{d}" width="80" style="font-weight: bold;"
								styleClass="#{d == 'Sun' ? 'sunday' : ''}" />
						</ui:repeat>
					</p:row>
				</p:columnGroup>


				<p:column width="80">
					<h:outputText value="#{t.employeeCode}" />
				</p:column>

				<p:column width="100">
					<h:outputText value="#{t.fullName}" />
				</p:column>

				<p:column>
					<h:outputText value="Min IN" style="color: blue;" />
					<p:separator style="width: 100px; margin-left: -10px;" />
					<h:outputText value="Max OUT" />
				</p:column>

				<p:columns value="#{timeTrackingReportBean.datesOfMonthStrings}"
					var="d">
					<h:outputText value="#{t.getMinIn(d)}" style="color: blue;" />
					<p:separator style="width: 100px; margin-left: -10px;" />
					<h:outputText value="#{t.getMaxOut(d)}" style="color: black;" />
				</p:columns>

				<p:column>
					<h:outputText value="#{t.grandTotalMinIn}" style="color: blue;" />
					<p:separator style="width: 100px; margin-left: -10px;" />
					<h:outputText value="#{t.grandTotalMaxOut}" style="color: black;" />
				</p:column>
			</p:dataTable>
		</h:form>

	</h:body>

	<style type="text/css">
.sunday>span.ui-column-title {
	color: red !important;
}
</style>
</f:view>